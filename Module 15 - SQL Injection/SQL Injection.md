<div _ngcontent-ng-c2673589256="" inline-copy-host="" class="markdown markdown-main-panel stronger enable-updated-hr-color" id="model-response-message-contentr_a445778a38585557" aria-live="polite" aria-busy="false" dir="ltr" style="--animation-duration: 400ms; --fade-animation-function: linear;"><h2 data-path-to-node="0">üí• M√≥dulo 15: O Terremoto Digital ‚Äî <b>Inje√ß√£o SQL (SQL Injection)</b> üí£</h2><hr data-path-to-node="1"><h3 data-path-to-node="2">üåê 1. Contexto da Amea√ßa (OWASP A03:2021)</h3><p data-path-to-node="3">A <b>Inje√ß√£o SQL</b> (SQLi) √© a falha de seguran√ßa que ocorre quando um atacante consegue interferir nas <i>queries</i> (consultas) que uma aplica√ß√£o Web faz √† sua <b>Base de Dados (Database - DB)</b>. Esta vulnerabilidade √© tipicamente explorada quando as entradas do utilizador (como campos de formul√°rio ou par√¢metros de URL) s√£o inclu√≠das diretamente num comando SQL sem a devida sanitiza√ß√£o.</p><ul data-path-to-node="4"><li><p data-path-to-node="4,0,0"><b>Risco Principal:</b> Acesso, modifica√ß√£o ou destrui√ß√£o de dados sens√≠veis na base de dados, escalada de privil√©gios e, em certos casos, at√© mesmo a obten√ß√£o de um <b>shell no sistema operacional</b> do servidor.</p></li><li><p data-path-to-node="4,1,0"><b>A Aplica√ß√£o no Lab:</b> O manual CEH v13 utiliza o <i>website</i> <b><code>http://www.moviescope.com/viewprofile.aspx?id=1</code></b> como alvo para demonstrar a explora√ß√£o.</p></li><div class="attachment-container search-images"><response-element class="" ng-version="0.0.0-PLACEHOLDER"><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><single-image _nghost-ng-c3606057549="" data-is-interactive="false" class="ng-star-inserted"><!----><div _ngcontent-ng-c3606057549="" class="image-container ng-star-inserted" data-full-size-image-uri="https://"><div _ngcontent-ng-c3606057549="" class="overlay-container ng-star-inserted"><!----><button _ngcontent-ng-c3606057549="" class="image-button ng-star-inserted" jslog="181501;track:generic_click,impression;BardVeMetadataKey:[[&quot;r_a445778a38585557&quot;,&quot;c_d821f286710ba78c&quot;,null,&quot;rc_0d15a5518bdc2eae&quot;,null,null,&quot;pt&quot;,null,1,null,null,1,0]];mutable:true"><img _ngcontent-ng-c3606057549="" loading="lazy" class="licensed-image loaded" alt="Imagem de SQL Injection vulnerability flow chart" src="https://"></button><!----><!----><!----><!----><!----><!----><!----><div _ngcontent-ng-c3606057549="" class="licensed-image-source ng-star-inserted"><span _ngcontent-ng-c3606057549="" class="label ellipsis gds-label-m-alt">Shutterstock</span></div><!----><!----><!----></div><!----><!----></div><!----><!----><!----><!----><!----><!----></single-image><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></response-element></div></ul><hr data-path-to-node="6"><h3 data-path-to-node="7">üéØ 2. Objetivos de Aprendizagem do M√≥dulo</h3><p data-path-to-node="8">O objetivo central deste m√≥dulo √© treinar o <i>Ethical Hacker</i> na identifica√ß√£o, explora√ß√£o e, crucialmente, na mitiga√ß√£o da Inje√ß√£o SQL, usando ferramentas automatizadas para acelerar o processo.</p><div class="horizontal-scroll-wrapper"><div class="table-block-component"><response-element class="" ng-version="0.0.0-PLACEHOLDER"><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><table-block _nghost-ng-c984690523="" class="ng-star-inserted"><div _ngcontent-ng-c984690523="" class="table-block has-export-button"><div _ngcontent-ng-c984690523="" not-end-of-paragraph="" class="table-content not-end-of-paragraph" jslog="275421;track:impression,attention" data-hveid="0" decode-data-ved="1" data-ved="0CAAQ3ecQahgKEwiGw7zijJ-RAxUAAAAAHQAAAAAQhBM"><table data-path-to-node="9"><thead><tr><td><span data-path-to-node="9,0,0,0">Foco</span></td><td><span data-path-to-node="9,0,1,0">Descri√ß√£o</span></td></tr></thead><tbody><tr><td><span data-path-to-node="9,1,0,0"><b>Avalia√ß√£o Automatizada</b></span></td><td><span data-path-to-node="9,1,1,0">Aprender a usar o <b>sqlmap</b> para detetar <i>endpoints</i> vulner√°veis.</span></td></tr><tr><td><span data-path-to-node="9,2,0,0"><b>T√©cnicas de Explora√ß√£o</b></span></td><td><span data-path-to-node="9,2,1,0">Dominar ataques <b>Cegos (Blind)</b>, baseados em tempo, e ataques de <b>Consulta UNION</b>.</span></td></tr><tr><td><span data-path-to-node="9,3,0,0"><b>Escalada de Impacto</b></span></td><td><span data-path-to-node="9,3,1,0">Tentar obter um <i>shell</i> do <b>Sistema Operacional (OS Shell)</b> atrav√©s da vulnerabilidade SQL.</span></td></tr></tbody></table></div><div _ngcontent-ng-c984690523="" hide-from-message-actions="" class="table-footer hide-from-message-actions ng-star-inserted"><button _ngcontent-ng-c984690523="" mat-button="" class="mdc-button mat-mdc-button-base export-sheets-button-container mat-mdc-button mat-unthemed ng-star-inserted" mat-ripple-loader-uninitialized="" mat-ripple-loader-class-name="mat-mdc-button-ripple" jslog="184701;track:generic_click,impression;BardVeMetadataKey:[[&quot;r_a445778a38585557&quot;,&quot;c_d821f286710ba78c&quot;,null,null,null,null,null,null,1,null,null,null,0]]"><span class="mat-mdc-button-persistent-ripple mdc-button__ripple"></span><span class="mdc-button__label"><span _ngcontent-ng-c984690523="" class="export-sheets-button"><span _ngcontent-ng-c984690523="" class="export-sheets-icon"><mat-icon _ngcontent-ng-c984690523="" role="img" fonticon="drive_spreadsheet" class="mat-icon notranslate google-symbols mat-ligature-font mat-icon-no-color" aria-hidden="true" data-mat-icon-type="font" data-mat-icon-name="drive_spreadsheet"></mat-icon></span><span _ngcontent-ng-c984690523="">Exportar para as Planilhas</span></span></span><span class="mat-focus-indicator"></span><span class="mat-mdc-button-touch-target"></span></button><!----><button _ngcontent-ng-c984690523="" mat-icon-button="" mattooltip="Copiar tabela" aria-label="Copiar tabela" data-test-id="copy-table-button" class="mdc-icon-button mat-mdc-icon-button mat-mdc-button-base mat-mdc-tooltip-trigger copy-button mat-unthemed ng-star-inserted" mat-ripple-loader-uninitialized="" mat-ripple-loader-class-name="mat-mdc-button-ripple" mat-ripple-loader-centered="" jslog="276666;track:generic_click,impression;BardVeMetadataKey:[[&quot;r_a445778a38585557&quot;,&quot;c_d821f286710ba78c&quot;,null,null,null,null,null,null,1,null,null,null,0]]"><span class="mat-mdc-button-persistent-ripple mdc-icon-button__ripple"></span><mat-icon _ngcontent-ng-c984690523="" role="img" fonticon="content_copy" class="mat-icon notranslate gds-icon-l google-symbols mat-ligature-font mat-icon-no-color" aria-hidden="true" data-mat-icon-type="font" data-mat-icon-name="content_copy"></mat-icon><span class="mat-focus-indicator"></span><span class="mat-mdc-button-touch-target"></span></button><!----><!----><!----></div><!----></div><!----></table-block><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></response-element></div></div><hr data-path-to-node="10"><h3 data-path-to-node="11">üíª 3. Explora√ß√£o na Pr√°tica: A Arma Principal (<code>sqlmap</code>)</h3><p data-path-to-node="12">O laborat√≥rio foca-se na utiliza√ß√£o do <b>sqlmap</b>, a ferramenta <i>standard</i> da ind√∫stria para automatizar o processo de explora√ß√£o de SQLi. O <code>sqlmap</code> testa diversos tipos de <i>payloads</i> e t√©cnicas de extra√ß√£o de dados.</p><h4 data-path-to-node="13">üìù T√©cnicas e <i>Payloads</i> Chave (Conforme o PDF)</h4><p data-path-to-node="14">O <code>sqlmap</code> √© demonstrado a identificar e a testar as seguintes t√©cnicas no alvo:</p><div class="horizontal-scroll-wrapper"><div class="table-block-component"><response-element class="" ng-version="0.0.0-PLACEHOLDER"><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><table-block _nghost-ng-c984690523="" class="ng-star-inserted"><div _ngcontent-ng-c984690523="" class="table-block has-export-button"><div _ngcontent-ng-c984690523="" not-end-of-paragraph="" class="table-content not-end-of-paragraph" jslog="275421;track:impression,attention" data-hveid="0" decode-data-ved="1" data-ved="0CAAQ3ecQahgKEwiGw7zijJ-RAxUAAAAAHQAAAAAQhxM"><table data-path-to-node="15"><thead><tr><td><span data-path-to-node="15,0,0,0">T√©cnica</span></td><td><span data-path-to-node="15,0,1,0">T√≠tulo da Inje√ß√£o</span></td><td><span data-path-to-node="15,0,2,0"><i>Payload</i> Exemplo (Identificado pelo <code>sqlmap</code>)</span></td></tr></thead><tbody><tr><td><span data-path-to-node="15,1,0,0"><b>Cega Baseada em Tempo</b></span></td><td><span data-path-to-node="15,1,1,0"><b>Microsoft SQL Server/Sybase time-based blind (IF)</b></span></td><td><span data-path-to-node="15,1,2,0"><code>$id=1$ **WAITFOR DELAY 10:0:5**</code></span></td></tr><tr><td><span data-path-to-node="15,2,0,0"><b>Consulta UNION</b></span></td><td><span data-path-to-node="15,2,1,0"><b>Generic UNION query (NULL) 10 columns</b></span></td><td><span data-path-to-node="15,2,2,0"><code>$id=1$ **UNION ALL SELECT NULL, NULL, NULL,** ...</code></span></td></tr></tbody></table></div><div _ngcontent-ng-c984690523="" hide-from-message-actions="" class="table-footer hide-from-message-actions ng-star-inserted"><button _ngcontent-ng-c984690523="" mat-button="" class="mdc-button mat-mdc-button-base export-sheets-button-container mat-mdc-button mat-unthemed ng-star-inserted" mat-ripple-loader-uninitialized="" mat-ripple-loader-class-name="mat-mdc-button-ripple" jslog="184701;track:generic_click,impression;BardVeMetadataKey:[[&quot;r_a445778a38585557&quot;,&quot;c_d821f286710ba78c&quot;,null,null,null,null,null,null,1,null,null,null,0]]"><span class="mat-mdc-button-persistent-ripple mdc-button__ripple"></span><span class="mdc-button__label"><span _ngcontent-ng-c984690523="" class="export-sheets-button"><span _ngcontent-ng-c984690523="" class="export-sheets-icon"><mat-icon _ngcontent-ng-c984690523="" role="img" fonticon="drive_spreadsheet" class="mat-icon notranslate google-symbols mat-ligature-font mat-icon-no-color" aria-hidden="true" data-mat-icon-type="font" data-mat-icon-name="drive_spreadsheet"></mat-icon></span><span _ngcontent-ng-c984690523="">Exportar para as Planilhas</span></span></span><span class="mat-focus-indicator"></span><span class="mat-mdc-button-touch-target"></span></button><!----><button _ngcontent-ng-c984690523="" mat-icon-button="" mattooltip="Copiar tabela" aria-label="Copiar tabela" data-test-id="copy-table-button" class="mdc-icon-button mat-mdc-icon-button mat-mdc-button-base mat-mdc-tooltip-trigger copy-button mat-unthemed ng-star-inserted" mat-ripple-loader-uninitialized="" mat-ripple-loader-class-name="mat-mdc-button-ripple" mat-ripple-loader-centered="" jslog="276666;track:generic_click,impression;BardVeMetadataKey:[[&quot;r_a445778a38585557&quot;,&quot;c_d821f286710ba78c&quot;,null,null,null,null,null,null,1,null,null,null,0]]"><span class="mat-mdc-button-persistent-ripple mdc-icon-button__ripple"></span><mat-icon _ngcontent-ng-c984690523="" role="img" fonticon="content_copy" class="mat-icon notranslate gds-icon-l google-symbols mat-ligature-font mat-icon-no-color" aria-hidden="true" data-mat-icon-type="font" data-mat-icon-name="content_copy"></mat-icon><span class="mat-focus-indicator"></span><span class="mat-mdc-button-touch-target"></span></button><!----><!----><!----></div><!----></div><!----></table-block><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></response-element></div></div><p data-path-to-node="16"><b>Ataque Final: Obten√ß√£o de OS Shell</b></p><p data-path-to-node="17">O manual demonstra o comando para tentar obter um <i>shell</i> interativo do Sistema Operacional no servidor alvo, explorando fun√ß√µes da base de dados com privil√©gios de escrita/leitura:</p><response-element class="" ng-version="0.0.0-PLACEHOLDER"><!----><!----><!----><!----><code-block _nghost-ng-c2766598292="" class="ng-tns-c2766598292-271 ng-star-inserted" style=""><!----><!----><div _ngcontent-ng-c2766598292="" class="code-block ng-tns-c2766598292-271 ng-animate-disabled ng-trigger ng-trigger-codeBlockRevealAnimation" jslog="223238;track:impression,attention;BardVeMetadataKey:[[&quot;r_a445778a38585557&quot;,&quot;c_d821f286710ba78c&quot;,null,&quot;rc_0d15a5518bdc2eae&quot;,null,null,&quot;pt&quot;,null,1,null,null,1,0]]" style="display: block;" data-hveid="0" decode-data-ved="1" data-ved="0CAAQhtANahgKEwiGw7zijJ-RAxUAAAAAHQAAAAAQihM"><div _ngcontent-ng-c2766598292="" class="code-block-decoration header-formatted gds-title-s ng-tns-c2766598292-271 ng-star-inserted" style=""><span _ngcontent-ng-c2766598292="" class="ng-tns-c2766598292-271">Bash</span><div _ngcontent-ng-c2766598292="" class="buttons ng-tns-c2766598292-271 ng-star-inserted"><button _ngcontent-ng-c2766598292="" aria-label="Copiar o c√≥digo" mat-icon-button="" mattooltip="Copiar o c√≥digo" class="mdc-icon-button mat-mdc-icon-button mat-mdc-button-base mat-mdc-tooltip-trigger copy-button ng-tns-c2766598292-271 mat-unthemed ng-star-inserted" mat-ripple-loader-uninitialized="" mat-ripple-loader-class-name="mat-mdc-button-ripple" mat-ripple-loader-centered="" jslog="179062;track:generic_click,impression;BardVeMetadataKey:[[&quot;r_a445778a38585557&quot;,&quot;c_d821f286710ba78c&quot;,null,&quot;rc_0d15a5518bdc2eae&quot;,null,null,&quot;pt&quot;,null,1,null,null,1,0]];mutable:true"><span class="mat-mdc-button-persistent-ripple mdc-icon-button__ripple"></span><mat-icon _ngcontent-ng-c2766598292="" role="img" fonticon="content_copy" class="mat-icon notranslate google-symbols mat-ligature-font mat-icon-no-color" aria-hidden="true" data-mat-icon-type="font" data-mat-icon-name="content_copy"></mat-icon><span class="mat-focus-indicator"></span><span class="mat-mdc-button-touch-target"></span></button><!----><!----></div><!----></div><!----><div _ngcontent-ng-c2766598292="" class="formatted-code-block-internal-container ng-tns-c2766598292-271"><div _ngcontent-ng-c2766598292="" class="animated-opacity ng-tns-c2766598292-271"><pre _ngcontent-ng-c2766598292="" class="ng-tns-c2766598292-271"><code _ngcontent-ng-c2766598292="" role="text" data-test-id="code-content" class="code-container formatted ng-tns-c2766598292-271">sqlmap -u <span class="hljs-string">"[URL_VULNER√ÅVEL]"</span> --cookie=<span class="hljs-string">"[COOKIE]"</span> --os-shell
</code></pre><!----></div></div></div><!----><!----></code-block><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></response-element><ul data-path-to-node="19"><li><p data-path-to-node="19,0,0">O <i>flag</i> <b><code>--os-shell</code></b> solicita ao <code>sqlmap</code> que tente estabelecer um <i>shell</i> de comando no SO do servidor de destino.</p></li><li><p data-path-to-node="19,1,0">Se o servidor for vulner√°vel e o utilizador da base de dados tiver privil√©gios de escrita/leitura no disco, o atacante pode executar comandos como se estivesse no servidor.</p></li></ul><hr data-path-to-node="20"><h3 data-path-to-node="21">üõ°Ô∏è 4. Contramedidas Essenciais (Mitiga√ß√£o)</h3><p data-path-to-node="22">O principal objetivo defensivo √© garantir que a entrada do utilizador <b>nunca</b> seja tratada como parte do c√≥digo SQL.</p><div class="horizontal-scroll-wrapper"><div class="table-block-component"><response-element class="" ng-version="0.0.0-PLACEHOLDER"><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><table-block _nghost-ng-c984690523="" class="ng-star-inserted"><div _ngcontent-ng-c984690523="" class="table-block has-export-button"><div _ngcontent-ng-c984690523="" not-end-of-paragraph="" class="table-content not-end-of-paragraph" jslog="275421;track:impression,attention" data-hveid="0" decode-data-ved="1" data-ved="0CAAQ3ecQahgKEwiGw7zijJ-RAxUAAAAAHQAAAAAQixM"><table data-path-to-node="23"><thead><tr><td><span data-path-to-node="23,0,0,0">Contramedida</span></td><td><span data-path-to-node="23,0,1,0">Princ√≠pio de Seguran√ßa</span></td></tr></thead><tbody><tr><td><span data-path-to-node="23,1,0,0"><b>Consultas Parametrizadas (Prepared Statements)</b></span></td><td><span data-path-to-node="23,1,1,0"><b>A defesa mais eficaz.</b> Separa o c√≥digo SQL da entrada do utilizador, tratando o <i>input</i> sempre como <b>dados</b> (string/vari√°vel) e n√£o como comando execut√°vel.</span></td></tr><tr><td><span data-path-to-node="23,2,0,0"><b>Princ√≠pio do Privil√©gio M√≠nimo</b></span></td><td><span data-path-to-node="23,2,1,0">As contas de servi√ßo que acedem √† DB devem ter apenas as permiss√µes essenciais (ex: apenas <code>SELECT</code> para <i>queries</i> p√∫blicas), prevenindo que ataques bem-sucedidos causem danos extensos.</span></td></tr><tr><td><span data-path-to-node="23,3,0,0"><b>Valida√ß√£o de Entrada (Input Validation)</b></span></td><td><span data-path-to-node="23,3,1,0">Usar <b>listas brancas (whitelisting)</b> para garantir que a entrada corresponda ao formato esperado (ex: aceitar apenas d√≠gitos num campo de ID).</span></td></tr><tr><td><span data-path-to-node="23,4,0,0"><b>Web Application Firewall (WAF)</b></span></td><td><span data-path-to-node="23,4,1,0">Implantar um WAF para inspecionar e bloquear <i>payloads</i> de SQLi conhecidos antes que cheguem √† aplica√ß√£o.</span></td></tr></tbody></table></div><div _ngcontent-ng-c984690523="" hide-from-message-actions="" class="table-footer hide-from-message-actions ng-star-inserted"><button _ngcontent-ng-c984690523="" mat-button="" class="mdc-button mat-mdc-button-base export-sheets-button-container mat-mdc-button mat-unthemed ng-star-inserted" mat-ripple-loader-uninitialized="" mat-ripple-loader-class-name="mat-mdc-button-ripple" jslog="184701;track:generic_click,impression;BardVeMetadataKey:[[&quot;r_a445778a38585557&quot;,&quot;c_d821f286710ba78c&quot;,null,null,null,null,null,null,1,null,null,null,0]]"><span class="mat-mdc-button-persistent-ripple mdc-button__ripple"></span><span class="mdc-button__label"><span _ngcontent-ng-c984690523="" class="export-sheets-button"><span _ngcontent-ng-c984690523="" class="export-sheets-icon"><mat-icon _ngcontent-ng-c984690523="" role="img" fonticon="drive_spreadsheet" class="mat-icon notranslate google-symbols mat-ligature-font mat-icon-no-color" aria-hidden="true" data-mat-icon-type="font" data-mat-icon-name="drive_spreadsheet"></mat-icon></span><span _ngcontent-ng-c984690523="">Exportar para as Planilhas</span></span></span><span class="mat-focus-indicator"></span><span class="mat-mdc-button-touch-target"></span></button><!----><button _ngcontent-ng-c984690523="" mat-icon-button="" mattooltip="Copiar tabela" aria-label="Copiar tabela" data-test-id="copy-table-button" class="mdc-icon-button mat-mdc-icon-button mat-mdc-button-base mat-mdc-tooltip-trigger copy-button mat-unthemed ng-star-inserted" mat-ripple-loader-uninitialized="" mat-ripple-loader-class-name="mat-mdc-button-ripple" mat-ripple-loader-centered="" jslog="276666;track:generic_click,impression;BardVeMetadataKey:[[&quot;r_a445778a38585557&quot;,&quot;c_d821f286710ba78c&quot;,null,null,null,null,null,null,1,null,null,null,0]]"><span class="mat-mdc-button-persistent-ripple mdc-icon-button__ripple"></span><mat-icon _ngcontent-ng-c984690523="" role="img" fonticon="content_copy" class="mat-icon notranslate gds-icon-l google-symbols mat-ligature-font mat-icon-no-color" aria-hidden="true" data-mat-icon-type="font" data-mat-icon-name="content_copy"></mat-icon><span class="mat-focus-indicator"></span><span class="mat-mdc-button-touch-target"></span></button><!----><!----><!----></div><!----></div><!----></table-block><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></response-element></div></div></div>